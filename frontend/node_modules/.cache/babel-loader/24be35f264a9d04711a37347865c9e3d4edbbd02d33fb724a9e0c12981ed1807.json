{"ast":null,"code":"import _objectSpread from\"/Users/luuduylinh/Desktop/PhoneStore/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/luuduylinh/Desktop/PhoneStore/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/luuduylinh/Desktop/PhoneStore/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/luuduylinh/Desktop/PhoneStore/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState,useRef}from'react';import{faCircleXmark,faSearch,faSpinner}from'@fortawesome/free-solid-svg-icons';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import HeadlessTippy from'@tippyjs/react/headless';import classNames from'classnames/bind';import*as productService from\"../../services/productService\";import{Wrapper as PopperWrapper}from\"../Popper\";import{useDebounce}from\"../../hooks\";import styles from\"./Search.module.scss\";import Productsearch from\"../Productsearch\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var cx=classNames.bind(styles);function Search(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchValue=_useState2[0],setSearchValue=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),searchResult=_useState4[0],setSearchResult=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),showResult=_useState6[0],setShowResult=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var debouncedValue=useDebounce(searchValue,500);var inputRef=useRef();useEffect(function(){if(!debouncedValue.trim()){setSearchResult([]);return;}var fetchApi=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setLoading(true);_context.next=3;return productService.searchProduct(debouncedValue);case 3:result=_context.sent;setSearchResult(result);setLoading(false);case 6:case\"end\":return _context.stop();}},_callee);}));return function fetchApi(){return _ref.apply(this,arguments);};}();fetchApi();},[debouncedValue]);var handleClear=function handleClear(){setSearchValue('');setSearchResult([]);inputRef.current.focus();};var handleHideResult=function handleHideResult(){setShowResult(false);};var handleChange=function handleChange(e){var searchValue=e.target.value;if(!searchValue.startsWith(' ')||searchValue.trim()){setSearchValue(searchValue);}};return/*#__PURE__*/ (// Using a wrapper <div> tag around the reference element solves\n// this by creating a new parentNode context.\n_jsx(\"div\",{children:/*#__PURE__*/_jsx(HeadlessTippy,{interactive:true,visible:showResult&&(searchResult===null||searchResult===void 0?void 0:searchResult.length)>0,render:function render(attrs){return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({className:cx('search-result'),tabIndex:\"-1\"},attrs),{},{children:/*#__PURE__*/_jsxs(PopperWrapper,{children:[/*#__PURE__*/_jsx(\"h4\",{className:cx('search-title'),children:\"S\\u1EA3n ph\\u1EA9m\"}),searchResult===null||searchResult===void 0?void 0:searchResult.map(function(result,index){return/*#__PURE__*/_jsx(Productsearch,{result:result},index);})]})}));},onClickOutside:handleHideResult,children:/*#__PURE__*/_jsxs(\"div\",{className:cx('search'),children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,value:searchValue,placeholder:\"T\\xECm ki\\u1EBFm s\\u1EA3n ph\\u1EA9m t\\u1EA1i \\u0111\\xE2y\",spellCheck:false,onChange:handleChange,onFocus:function onFocus(){return setShowResult(true);}}),!!searchValue&&!loading&&/*#__PURE__*/_jsx(\"button\",{className:cx('clear'),onClick:handleClear,children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCircleXmark})}),loading&&/*#__PURE__*/_jsx(FontAwesomeIcon,{className:cx('loading'),icon:faSpinner}),/*#__PURE__*/_jsx(\"button\",{className:cx('search-btn'),onMouseDown:function onMouseDown(e){return e.preventDefault();},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSearch})})]})})}));}export default Search;","map":{"version":3,"names":["useEffect","useState","useRef","faCircleXmark","faSearch","faSpinner","FontAwesomeIcon","HeadlessTippy","classNames","productService","Wrapper","PopperWrapper","useDebounce","styles","Productsearch","jsx","_jsx","jsxs","_jsxs","cx","bind","Search","_useState","_useState2","_slicedToArray","searchValue","setSearchValue","_useState3","_useState4","searchResult","setSearchResult","_useState5","_useState6","showResult","setShowResult","_useState7","_useState8","loading","setLoading","debouncedValue","inputRef","trim","fetchApi","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","result","wrap","_callee$","_context","prev","next","searchProduct","sent","stop","apply","arguments","handleClear","current","focus","handleHideResult","handleChange","e","target","value","startsWith","children","interactive","visible","length","render","attrs","_objectSpread","className","tabIndex","map","index","onClickOutside","ref","placeholder","spellCheck","onChange","onFocus","onClick","icon","onMouseDown","preventDefault"],"sources":["/Users/luuduylinh/Desktop/PhoneStore/src/components/Search/Search.js"],"sourcesContent":["import { useEffect, useState, useRef } from 'react';\nimport { faCircleXmark, faSearch, faSpinner } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport HeadlessTippy from '@tippyjs/react/headless';\nimport classNames from 'classnames/bind';\n\nimport * as productService from '~/services/productService';\nimport { Wrapper as PopperWrapper } from '~/components/Popper';\nimport { useDebounce } from '~/hooks';\nimport styles from './Search.module.scss';\nimport Productsearch from '../Productsearch';\n\nconst cx = classNames.bind(styles);\n\nfunction Search() {\n    const [searchValue, setSearchValue] = useState('');\n    const [searchResult, setSearchResult] = useState([]);\n    const [showResult, setShowResult] = useState(true);\n    const [loading, setLoading] = useState(false);\n\n    const debouncedValue = useDebounce(searchValue, 500);\n\n    const inputRef = useRef();\n\n    useEffect(() => {\n        if (!debouncedValue.trim()) {\n            setSearchResult([]);\n            return;\n        }\n\n        const fetchApi = async () => {\n            setLoading(true);\n\n            const result = await productService.searchProduct(debouncedValue);\n            setSearchResult(result);\n\n            setLoading(false);\n        };\n\n        fetchApi();\n    }, [debouncedValue]);\n\n    const handleClear = () => {\n        setSearchValue('');\n        setSearchResult([]);\n        inputRef.current.focus();\n    };\n\n    const handleHideResult = () => {\n        setShowResult(false);\n    };\n\n    const handleChange = (e) => {\n        const searchValue = e.target.value;\n        if (!searchValue.startsWith(' ') || searchValue.trim()) {\n            setSearchValue(searchValue);\n        }\n    };\n\n    return (\n        // Using a wrapper <div> tag around the reference element solves\n        // this by creating a new parentNode context.\n        <div>\n            <HeadlessTippy\n                interactive\n                visible={showResult && searchResult?.length > 0}\n                render={(attrs) => (\n                    <div className={cx('search-result')} tabIndex=\"-1\" {...attrs}>\n                        <PopperWrapper>\n                            <h4 className={cx('search-title')}>Sản phẩm</h4>\n                            {searchResult?.map((result, index) => (\n                                <Productsearch key={index} result={result} />\n                            ))}\n                        </PopperWrapper>\n                    </div>\n                )}\n                onClickOutside={handleHideResult}\n            >\n                <div className={cx('search')}>\n                    <input\n                        ref={inputRef}\n                        value={searchValue}\n                        placeholder=\"Tìm kiếm sản phẩm tại đây\"\n                        spellCheck={false}\n                        onChange={handleChange}\n                        onFocus={() => setShowResult(true)}\n                    />\n                    {!!searchValue && !loading && (\n                        <button className={cx('clear')} onClick={handleClear}>\n                            <FontAwesomeIcon icon={faCircleXmark} />\n                        </button>\n                    )}\n                    {loading && <FontAwesomeIcon className={cx('loading')} icon={faSpinner} />}\n                    <button className={cx('search-btn')} onMouseDown={(e) => e.preventDefault()}>\n                        <FontAwesomeIcon icon={faSearch} />\n                    </button>\n                </div>\n            </HeadlessTippy>\n        </div>\n    );\n}\n\nexport default Search;\n"],"mappings":"ufAAA,OAASA,SAAS,CAAEC,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CACnD,OAASC,aAAa,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,mCAAmC,CACtF,OAASC,eAAe,KAAQ,gCAAgC,CAChE,MAAO,CAAAC,aAAa,KAAM,yBAAyB,CACnD,MAAO,CAAAC,UAAU,KAAM,iBAAiB,CAExC,MAAO,GAAK,CAAAC,cAAc,qCAC1B,OAASC,OAAO,GAAI,CAAAC,aAAa,iBACjC,OAASC,WAAW,mBACpB,MAAO,CAAAC,MAAM,4BACb,MAAO,CAAAC,aAAa,wBAAyB,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE7C,GAAM,CAAAC,EAAE,CAAGX,UAAU,CAACY,IAAI,CAACP,MAAM,CAAC,CAElC,QAAS,CAAAQ,MAAMA,CAAA,CAAG,CACd,IAAAC,SAAA,CAAsCrB,QAAQ,CAAC,EAAE,CAAC,CAAAsB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA3CG,WAAW,CAAAF,UAAA,IAAEG,cAAc,CAAAH,UAAA,IAClC,IAAAI,UAAA,CAAwC1B,QAAQ,CAAC,EAAE,CAAC,CAAA2B,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA7CE,YAAY,CAAAD,UAAA,IAAEE,eAAe,CAAAF,UAAA,IACpC,IAAAG,UAAA,CAAoC9B,QAAQ,CAAC,IAAI,CAAC,CAAA+B,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAA3CE,UAAU,CAAAD,UAAA,IAAEE,aAAa,CAAAF,UAAA,IAChC,IAAAG,UAAA,CAA8BlC,QAAQ,CAAC,KAAK,CAAC,CAAAmC,UAAA,CAAAZ,cAAA,CAAAW,UAAA,IAAtCE,OAAO,CAAAD,UAAA,IAAEE,UAAU,CAAAF,UAAA,IAE1B,GAAM,CAAAG,cAAc,CAAG3B,WAAW,CAACa,WAAW,CAAE,GAAG,CAAC,CAEpD,GAAM,CAAAe,QAAQ,CAAGtC,MAAM,CAAC,CAAC,CAEzBF,SAAS,CAAC,UAAM,CACZ,GAAI,CAACuC,cAAc,CAACE,IAAI,CAAC,CAAC,CAAE,CACxBX,eAAe,CAAC,EAAE,CAAC,CACnB,OACJ,CAEA,GAAM,CAAAY,QAAQ,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,MAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SACbf,UAAU,CAAC,IAAI,CAAC,CAACa,QAAA,CAAAE,IAAA,SAEI,CAAA5C,cAAc,CAAC6C,aAAa,CAACf,cAAc,CAAC,QAA3DS,MAAM,CAAAG,QAAA,CAAAI,IAAA,CACZzB,eAAe,CAACkB,MAAM,CAAC,CAEvBV,UAAU,CAAC,KAAK,CAAC,CAAC,wBAAAa,QAAA,CAAAK,IAAA,MAAAT,OAAA,GACrB,kBAPK,CAAAL,QAAQA,CAAA,SAAAC,IAAA,CAAAc,KAAA,MAAAC,SAAA,OAOb,CAEDhB,QAAQ,CAAC,CAAC,CACd,CAAC,CAAE,CAACH,cAAc,CAAC,CAAC,CAEpB,GAAM,CAAAoB,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAS,CACtBjC,cAAc,CAAC,EAAE,CAAC,CAClBI,eAAe,CAAC,EAAE,CAAC,CACnBU,QAAQ,CAACoB,OAAO,CAACC,KAAK,CAAC,CAAC,CAC5B,CAAC,CAED,GAAM,CAAAC,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAA,CAAS,CAC3B5B,aAAa,CAAC,KAAK,CAAC,CACxB,CAAC,CAED,GAAM,CAAA6B,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAIC,CAAC,CAAK,CACxB,GAAM,CAAAvC,WAAW,CAAGuC,CAAC,CAACC,MAAM,CAACC,KAAK,CAClC,GAAI,CAACzC,WAAW,CAAC0C,UAAU,CAAC,GAAG,CAAC,EAAI1C,WAAW,CAACgB,IAAI,CAAC,CAAC,CAAE,CACpDf,cAAc,CAACD,WAAW,CAAC,CAC/B,CACJ,CAAC,CAED,oBACI;AACA;AACAT,IAAA,QAAAoD,QAAA,cACIpD,IAAA,CAACT,aAAa,EACV8D,WAAW,MACXC,OAAO,CAAErC,UAAU,EAAI,CAAAJ,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAE0C,MAAM,EAAG,CAAE,CAChDC,MAAM,CAAE,SAAAA,OAACC,KAAK,qBACVzD,IAAA,OAAA0D,aAAA,CAAAA,aAAA,EAAKC,SAAS,CAAExD,EAAE,CAAC,eAAe,CAAE,CAACyD,QAAQ,CAAC,IAAI,EAAKH,KAAK,MAAAL,QAAA,cACxDlD,KAAA,CAACP,aAAa,EAAAyD,QAAA,eACVpD,IAAA,OAAI2D,SAAS,CAAExD,EAAE,CAAC,cAAc,CAAE,CAAAiD,QAAA,CAAC,oBAAQ,CAAI,CAAC,CAC/CvC,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEgD,GAAG,CAAC,SAAC7B,MAAM,CAAE8B,KAAK,qBAC7B9D,IAAA,CAACF,aAAa,EAAakC,MAAM,CAAEA,MAAO,EAAtB8B,KAAwB,CAAC,EAChD,CAAC,EACS,CAAC,EACf,CAAC,EACR,CACFC,cAAc,CAAEjB,gBAAiB,CAAAM,QAAA,cAEjClD,KAAA,QAAKyD,SAAS,CAAExD,EAAE,CAAC,QAAQ,CAAE,CAAAiD,QAAA,eACzBpD,IAAA,UACIgE,GAAG,CAAExC,QAAS,CACd0B,KAAK,CAAEzC,WAAY,CACnBwD,WAAW,CAAC,0DAA2B,CACvCC,UAAU,CAAE,KAAM,CAClBC,QAAQ,CAAEpB,YAAa,CACvBqB,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAAlD,aAAa,CAAC,IAAI,CAAC,EAAC,CACtC,CAAC,CACD,CAAC,CAACT,WAAW,EAAI,CAACY,OAAO,eACtBrB,IAAA,WAAQ2D,SAAS,CAAExD,EAAE,CAAC,OAAO,CAAE,CAACkE,OAAO,CAAE1B,WAAY,CAAAS,QAAA,cACjDpD,IAAA,CAACV,eAAe,EAACgF,IAAI,CAAEnF,aAAc,CAAE,CAAC,CACpC,CACX,CACAkC,OAAO,eAAIrB,IAAA,CAACV,eAAe,EAACqE,SAAS,CAAExD,EAAE,CAAC,SAAS,CAAE,CAACmE,IAAI,CAAEjF,SAAU,CAAE,CAAC,cAC1EW,IAAA,WAAQ2D,SAAS,CAAExD,EAAE,CAAC,YAAY,CAAE,CAACoE,WAAW,CAAE,SAAAA,YAACvB,CAAC,QAAK,CAAAA,CAAC,CAACwB,cAAc,CAAC,CAAC,EAAC,CAAApB,QAAA,cACxEpD,IAAA,CAACV,eAAe,EAACgF,IAAI,CAAElF,QAAS,CAAE,CAAC,CAC/B,CAAC,EACR,CAAC,CACK,CAAC,CACf,CAAC,EAEd,CAEA,cAAe,CAAAiB,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}