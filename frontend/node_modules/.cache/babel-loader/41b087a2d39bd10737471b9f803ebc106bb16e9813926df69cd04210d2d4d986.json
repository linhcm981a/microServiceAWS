{"ast":null,"code":"import _objectSpread from\"/Users/luuduylinh/Desktop/PhoneStore/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"/Users/luuduylinh/Desktop/PhoneStore/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/luuduylinh/Desktop/PhoneStore/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import classNames from'classnames/bind';import Tippy from'@tippyjs/react/headless';import{Wrapper as PopperWrapper}from\"./..\";import MenuItem from\"./MenuItem\";import Header from\"./Header\";import styles from\"./Menu.module.scss\";import{useState}from'react';import{useDispatch,useSelector}from'react-redux';import*as authService from\"../../../services/authService\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var cx=classNames.bind(styles);function Menu(_ref){var children=_ref.children,_ref$items=_ref.items,items=_ref$items===void 0?[]:_ref$items,_ref$hideOnClick=_ref.hideOnClick,hideOnClick=_ref$hideOnClick===void 0?false:_ref$hideOnClick;var _useState=useState([{data:items}]),_useState2=_slicedToArray(_useState,2),history=_useState2[0],setHistory=_useState2[1];var current=history[history.length-1];var dispatch=useDispatch();var token=useSelector(function(state){return state.auth.login.currentUser.accessToken;});var renderItems=function renderItems(){return current.data.map(function(item,index){var isParent=!!item.children;return/*#__PURE__*/_jsx(MenuItem,{data:item,onClick:function onClick(){if(isParent){setHistory(function(prev){return[].concat(_toConsumableArray(prev),[item.children]);});}else if(index===current.data.length-1){// Log out here\nhandleLogout();}}},index);});};var handleBack=function handleBack(){setHistory(function(prev){return prev.slice(0,prev.length-1);});};var handleLogout=function handleLogout(){authService.logout(dispatch,token);};var renderResult=function renderResult(attrs){return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({className:cx('menu-list'),tabIndex:\"-1\"},attrs),{},{children:/*#__PURE__*/_jsxs(PopperWrapper,{className:cx('menu-popper'),children:[history.length>1&&/*#__PURE__*/_jsx(Header,{title:current.title,onBack:handleBack}),/*#__PURE__*/_jsx(\"div\",{className:cx('menu-body'),children:renderItems()})]})}));};//Reset to first page\nvar handleResetMenu=function handleResetMenu(){setHistory(function(prev){return prev.slice(0,1);});};return/*#__PURE__*/_jsx(Tippy,{interactive:true,delay:[0,700],offset:[12,8],hideOnClick:hideOnClick,placement:\"bottom-end\",render:renderResult,onHide:handleResetMenu,children:children});}export default Menu;","map":{"version":3,"names":["classNames","Tippy","Wrapper","PopperWrapper","MenuItem","Header","styles","useState","useDispatch","useSelector","authService","jsx","_jsx","jsxs","_jsxs","cx","bind","Menu","_ref","children","_ref$items","items","_ref$hideOnClick","hideOnClick","_useState","data","_useState2","_slicedToArray","history","setHistory","current","length","dispatch","token","state","auth","login","currentUser","accessToken","renderItems","map","item","index","isParent","onClick","prev","concat","_toConsumableArray","handleLogout","handleBack","slice","logout","renderResult","attrs","_objectSpread","className","tabIndex","title","onBack","handleResetMenu","interactive","delay","offset","placement","render","onHide"],"sources":["/Users/luuduylinh/Desktop/PhoneStore/src/components/Popper/Menu/Menu.js"],"sourcesContent":["import classNames from 'classnames/bind';\nimport Tippy from '@tippyjs/react/headless';\n\nimport { Wrapper as PopperWrapper } from '~/components/Popper';\nimport MenuItem from './MenuItem';\nimport Header from './Header';\nimport styles from './Menu.module.scss';\nimport { useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport * as authService from '~/services/authService';\n\nconst cx = classNames.bind(styles);\n\nfunction Menu({ children, items = [], hideOnClick = false }) {\n    const [history, setHistory] = useState([{ data: items }]);\n    const current = history[history.length - 1];\n    const dispatch = useDispatch();\n    const token = useSelector((state) => state.auth.login.currentUser.accessToken);\n\n    const renderItems = () => {\n        return current.data.map((item, index) => {\n            const isParent = !!item.children;\n\n            return (\n                <MenuItem\n                    key={index}\n                    data={item}\n                    onClick={() => {\n                        if (isParent) {\n                            setHistory((prev) => [...prev, item.children]);\n                        } else if (index === current.data.length - 1) {\n                            // Log out here\n                            handleLogout();\n                        }\n                    }}\n                />\n            );\n        });\n    };\n\n    const handleBack = () => {\n        setHistory((prev) => prev.slice(0, prev.length - 1));\n    };\n\n    const handleLogout = () => {\n        authService.logout(dispatch, token);\n    };\n\n    const renderResult = (attrs) => (\n        <div className={cx('menu-list')} tabIndex=\"-1\" {...attrs}>\n            <PopperWrapper className={cx('menu-popper')}>\n                {history.length > 1 && <Header title={current.title} onBack={handleBack} />}\n                <div className={cx('menu-body')}>{renderItems()}</div>\n            </PopperWrapper>\n        </div>\n    );\n\n    //Reset to first page\n\n    const handleResetMenu = () => {\n        setHistory((prev) => prev.slice(0, 1));\n    };\n\n    return (\n        <Tippy\n            interactive\n            delay={[0, 700]}\n            offset={[12, 8]}\n            hideOnClick={hideOnClick}\n            placement=\"bottom-end\"\n            render={renderResult}\n            onHide={handleResetMenu}\n        >\n            {children}\n        </Tippy>\n    );\n}\n\nexport default Menu;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}